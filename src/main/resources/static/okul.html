<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Ã–ÄŸrenci YÃ¶netimi</title>
</head>
<body>
<h1>ğŸ“ Ã–ÄŸrenci YÃ¶netim Paneli</h1>

<h2>ğŸ“‹ TÃ¼m Ã–ÄŸrenciler</h2>
<button onclick="getAll()">Listele</button>
<ul id="liste"></ul>

<h2>ğŸ” ID ile Ã–ÄŸrenci Getir</h2>
<input type="number" id="getIdInput" placeholder="Ã–ÄŸrenci ID">
<button onclick="getById()">GÃ¶ster</button>
<p id="getResult"></p>

<h2>â• Yeni Ã–ÄŸrenci Ekle</h2>
<input id="adInput" placeholder="Ad">
<input id="soyadInput" placeholder="Soyad">
<input id="durumInput" placeholder="Durum">
<button onclick="addOgrenci()">Ekle</button>

<h2>âŒ Ã–ÄŸrenci Sil (ID ile)</h2>
<input type="number" id="deleteIdInput" placeholder="Silinecek ID">
<button onclick="deleteById()">Sil</button>

<h2>âœï¸ Ã–ÄŸrenci GÃ¼ncelle (ID ile)</h2>
<input type="number" id="updateIdInput" placeholder="GÃ¼ncellenecek ID">
<input id="updateAd" placeholder="Yeni Ad">
<input id="updateSoyad" placeholder="Yeni Soyad">
<input id="updateDurum" placeholder="Yeni Durum">
<button onclick="updateOgrenci()">GÃ¼ncelle</button>

<script>
    const baseUrl = "http://localhost:8080/rest/api/ogrenci";

    function getAll() {
        fetch(`${baseUrl}/list`)
            .then(res => res.json())
            .then(data => {
                const ul = document.getElementById("liste");
                ul.innerHTML = "";
                data.forEach(o => {
                    const li = document.createElement("li");
                    li.textContent = `${o.ogrenci_id} - ${o.ogrenci_ad} ${o.ogrenci_soyad} (${o.durum})`;
                    ul.appendChild(li);
                });
            });
    }

    function getById() {
        const id = document.getElementById("getIdInput").value;
        fetch(`${baseUrl}/list/${id}`)
            .then(res => {
                if (!res.ok) throw new Error("BulunamadÄ±");
                return res.json();
            })
            .then(o => {
                document.getElementById("getResult").textContent =
                    `${o.ogrenci_id}: ${o.ogrenci_ad} ${o.ogrenci_soyad} (${o.durum})`;
            })
            .catch(() => {
                document.getElementById("getResult").textContent = "Ã–ÄŸrenci bulunamadÄ±.";
            });
    }

    function ekle() {
        const ad = document.getElementById("ad").value;
        const soyad = document.getElementById("soyad").value;
        const durum = document.getElementById("durum").value;

        fetch("http://localhost:8080/rest/api/ogrenci/save", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                ogrenci_ad: ad,
                ogrenci_soyad: soyad,
                durum: durum
            })
        })
            .then(res => res.json())
            .then(data => {
                alert("Ã–ÄŸrenci eklendi: " + data.ogrenci_id);
            })
            .catch(err => {
                console.error("Hata:", err);
            });
    }
    function deleteById() {
        const id = document.getElementById("deleteIdInput").value;
        fetch(`${baseUrl}/delete/${id}`, { method: "DELETE" })
            .then(() => {
                alert("Ã–ÄŸrenci silindi.");
                getAll();
            });
    }

    function updateOgrenci() {
        const id = document.getElementById("updateIdInput").value;
        const ad = document.getElementById("updateAd").value;
        const soyad = document.getElementById("updateSoyad").value;
        const durum = document.getElementById("updateDurum").value;

        fetch(`${baseUrl}/update/${id}`, {
            method: "PUT",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                ogrenci_ad: ad,
                ogrenci_soyad: soyad,
                durum: durum
            })
        })
            .then(res => {
                if (!res.ok) {
                    throw new Error("GÃ¼ncelleme baÅŸarÄ±sÄ±z.");
                }
                return res.json();
            })
            .then(() => {
                alert("Ã–ÄŸrenci gÃ¼ncellendi.");
                getAll();
            })
            .catch(() => alert("GÃ¼ncelleme sÄ±rasÄ±nda hata oluÅŸtu."));
    }
</script>
</body>
</html>